<!DOCTYPE html>
<html lang="en" class="lg-breathe-50">

<head>
  <meta charset="UTF-8">
  <title>PlusOne</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <script>
    const start = Date.now();
  </script>

  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/animate.css/3.5.2/animate.min.css" />
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/tachyons/4.9.0/tachyons.min.css" />
  <link rel="stylesheet" href="Styles/plusOne.css" />

  <!-- Load Font -->
  <link href="https://fonts.googleapis.com/css?family=Montserrat:100,100i,200,200i,300,300i,400,400i,500,500i,600,600i,700,700i,800,800i,900,900i"
    rel="stylesheet">

  <style>
    /*
#############
Breathe BG/LG
#############
*/

    .lg-breathe-50 {
      background: linear-gradient(45deg, #547FFF, #00B5B5, #00CC33, #57AD00, #AB8000, #FF4747, #FF30CB, #A952FF);
      background-size: 1600% 1600%;
      -webkit-animation: Breathe 500s ease infinite;
      -moz-animation: Breathe 500s ease infinite;
      -o-animation: Breathe 500s ease infinite;
      animation: Breathe 500s ease infinite;
    }

    @-webkit-keyframes Breathe {
      0% {
        background-position: 100% 0%
      }
      50% {
        background-position: 0% 100%
      }
      100% {
        background-position: 100% 0%
      }
    }

    @-moz-keyframes Breathe {
      0% {
        background-position: 100% 0%
      }
      50% {
        background-position: 0% 100%
      }
      100% {
        background-position: 100% 0%
      }
    }

    @-o-keyframes Breathe {
      0% {
        background-position: 100% 0%
      }
      50% {
        background-position: 0% 100%
      }
      100% {
        background-position: 100% 0%
      }
    }

    @keyframes Breathe {
      0% {
        background-position: 100% 0%
      }
      50% {
        background-position: 0% 100%
      }
      100% {
        background-position: 100% 0%
      }
    }

    @keyframes pulse {
      from {
        transform: scale3d(1, 1, 1);
      }

      15% {
        transform: scale3d(.95, .95, .95);
      }
      30% {
        transform: scale3d(1, 1, 1);
      }
      45% {
        transform: scale3d(.95, .95, .95);
      }

      to {
        transform: scale3d(1, 1, 1);
      }
    }

    .pulse {
      animation-name: pulse;
    }

    .animated {
      animation-duration: .8s;
      animation-fill-mode: both;
    }

    .animated.infinite {
      animation-iteration-count: infinite;
    }

    @media screen and (min-width:30em) {
      .bg-0-ns {
        background: transparent;
      }
    }
  </style>

  <meta name="apple-mobile-web-app-title" content="PlusOne">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black">

  <!-- Favicon starts -->
  <link rel="apple-touch-icon" sizes="180x180" href="favicon/apple-touch-icon.png">
  <link rel="icon" type="image/png" sizes="32x32" href="favicon/favicon-32x32.png">
  <link rel="icon" type="image/png" sizes="194x194" href="favicon/favicon-194x194.png">
  <link rel="icon" type="image/png" sizes="192x192" href="favicon/android-chrome-192x192.png">
  <link rel="icon" type="image/png" sizes="16x16" href="favicon/favicon-16x16.png">
  <link rel="manifest" href="favicon/manifest.json">
  <link rel="mask-icon" href="favicon/safari-pinned-tab.svg" color="#330064">
  <meta name="theme-color" content="#330064">
  <!-- Favicon ends -->
  <script type="text/javascript" src="PlusOnePWA.js"></script>
</head>

<body>
  <div style="width: 100%; height: 100vh; display: flex; justify-content: center; align-items: center;">
    <div class="pulse animated infinite" style="width:6em;">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 269.8 207.8">
        <defs>
          <style>
            .cls-1 {
              fill: #547fff;
            }

            .cls-2 {
              fill: #fff;
            }

            .cls-3 {
              fill: #ff30cb;
            }
          </style>
        </defs>
        <g id="Layer_2" data-name="Layer 2">
          <g id="Layer_1-2" data-name="Layer 1">
            <path d="M137.4 201.7C128.4 184 92.2 106 114 53.5a78.4 78.4 0 0 1 144.8 60c-21.8 52.6-102.6 82-121.4 88.2z" class="cls-1"
            />
            <path d="M186.4 10A73.4 73.4 0 0 1 254 111.7c-19.5 47.5-90.3 75.7-114 84C129 173 99 103 118.4 55.4a73.2 73.2 0 0 1 68-45.3m0-10a83.4 83.4 0 0 0-77.2 51.6C83.5 114 135 207.8 135 207.8s102.6-30 128.4-92.4A83.4 83.4 0 0 0 186.4 0z"
              class="cls-2" />
            <path d="M132.4 201.6C113.6 195.4 32.8 166 11 113.4a78.4 78.4 0 1 1 144.8-60c21.8 52.6-14.5 130.6-23.4 148.2z" class="cls-3"
            />
            <path d="M83.4 10a73.2 73.2 0 0 1 67.8 45.3c19.7 47.5-10.4 117.5-21.4 140.2-23.8-8.3-94.5-36.5-114.2-84A73.4 73.4 0 0 1 83.4 10m0-10a83.4 83.4 0 0 0-77 115.3C32.2 177.6 135 207.7 135 207.7s51.2-94 25.5-156.2A83.4 83.4 0 0 0 83.5 0z"
              class="cls-2" />
            <circle cx="83.4" cy="83.4" r="32.1" class="cls-2" transform="rotate(-22.5 83.413 83.41)" />
          </g>
        </g>
      </svg>
    </div>
  </div>
  <noscript style="width:50ch; padding: 1em;">
    Hey bud, Why are you not using JavaScript? We kinda depend on JavaScript to, like, do much of anything on this site. But look,
    If you tweet @dateplusone we'll start building non JS options of our site. Cool beans?
  </noscript>
</body>

<!-- <script type="text/javascript" src="/_compile/Events.elm"></script> -->
<script src="https://cdn.auth0.com/js/auth0/9.0.0/auth0.min.js"></script>
<script>
  //Removes splash and starts elm app.
  while (document.body.firstChild) {
    if ((Date.now() - start) > 1500) {
      document.body.removeChild(document.body.firstChild);
    }
  }
	//var app = Elm.Main.fullscreen();
	var webAuth = new auth0.WebAuth({
      domain: 'plusonedatingapp.auth0.com', // e.g., you.auth0.com
      clientID: 'V9DXVz9ylA_oLNRcHimDzU-haA__LCKm',
      responseType: 'token',
      //redirectUri: 'http://localhost:8000/index.html',
      redirectUri: 'http://plusone.dating/index.html'
    });
    var storedProfile = localStorage.getItem('profile');
    var storedToken = localStorage.getItem('token');
    var authData = storedProfile && storedToken ? { profile: JSON.parse(storedProfile), token: storedToken } : null;
    var elmApp = Elm.Main.fullscreen(authData);

    // Auth0 authorize subscription
    elmApp.ports.auth0authorize.subscribe(function(opts) {
      webAuth.authorize();
    });

    // Log out of Auth0 subscription
    elmApp.ports.auth0logout.subscribe(function(opts) {
      localStorage.removeItem('profile');
      localStorage.removeItem('token');
    });

    // Watching for hash after redirect
    webAuth.parseHash({ hash: window.location.hash }, function(err, authResult) {
      if (err) {
        return console.error(err);
      }
      if (authResult) {
        webAuth.client.userInfo(authResult.accessToken, function(err, profile) {
          var result = { err: null, ok: null };
          var token = authResult.accessToken;

          if (err) {
            result.err = err.details;
            // Ensure that optional fields are on the object
            result.err.name = result.err.name ? result.err.name : null;
            result.err.code = result.err.code ? result.err.code : null;
            result.err.statusCode = result.err.statusCode ? result.err.statusCode : null;
          }
          if (authResult) {
            result.ok = { profile: profile, token: token };
            localStorage.setItem('profile', JSON.stringify(profile));
            localStorage.setItem('token', token);
          }
          elmApp.ports.auth0authResult.send(result);
        });
        window.location.hash = '';
      }
    });
</script>

<script>
  // register serviceWorker
  navigator.serviceWorker.register('service-worker.js').then(function (reg) {
    console.log('◕‿◕', reg);
  }, function (err) {
    console.log('ಠ_ಠ', err);
  });
</script>

</html>